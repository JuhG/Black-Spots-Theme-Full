{"version":3,"sources":["../assets/scripts/load-more.js"],"names":["jQuery","$","get_next_url","p","bsloadmore","next_link","replace","cache_next_page","cache_version","page","get_next_page","data","next_page","cached","$button","remove","cb","loading","post","url","res","success","fail","xhr","textStatus","e","$list","$next","prepend","$nav","$link","find","length","parseInt","text","loadingText","action","nonce","query","window","load","setTimeout","click","preventDefault","append","addClass","history","pushState","attr"],"mappings":"AAAAA,OAAA,SAAAC,GAkCA,QAAAC,GAAAC,GACA,MAAAC,YAAAC,UAAAC,QAAA,OAAAH,GAGA,QAAAI,KACAC,EAAAC,EACAC,EAAA,SAAAC,GACAA,GACAC,EAAAD,EACAE,GAAA,GAEAC,EAAAC,WAKA,QAAAL,GAAAM,GAEA,MAAAH,IAAAL,IAAAC,GACAO,EAAAJ,GACAC,GAAA,EACAI,GAAA,MACAV,OAIAI,EAAAF,KAAAA,MACAR,GAAAiB,KAAAd,WAAAe,IAAAR,EAAA,SAAAS,GACAA,EAAAC,SACAL,EAAAI,EAAAT,MACAM,GAAA,GAEAD,EAAA,MAGAM,KAAA,SAAAC,EAAAC,EAAAC,GACAT,EAAA,OApEA,GAAAU,GAAAzB,EAAA,iBAGA0B,EAAA1B,EAAA,YACAyB,GAAAE,QAAAD,EAEA,IAAAE,GAAA5B,EAAA,qBACAa,EAAAb,EAAA,iBACA6B,EAAAhB,EAAAiB,KAAA,IAEA,IAAAjB,EAAAkB,OAAA,CAEA,GAAAvB,GAAAwB,SAAA7B,WAAAK,MAAA,EACAD,EAAAC,EACAQ,GAAA,EACAJ,GAAA,EACAqB,EAAAJ,EAAAI,OACAC,EAAA/B,WAAA+B,YAEAvB,EAAA,GAEAD,GACAyB,OAAA,oBACAC,MAAAjC,WAAAiC,MACA5B,KAAAA,EACA6B,MAAAlC,WAAAkC,MAoDArC,GAAAsC,QAAAC,KAAA,WACAC,WAAA,WACAlC,KACA,OAGAO,EAAA4B,MAAA,SAAAjB,GACAA,EAAAkB,iBACA1B,IACAA,GAAA,EACAa,EAAAI,KAAAC,GAEAzB,EAAA,SAAAC,GACAe,EAAAkB,OAAAjC,GAAAiC,OAAAf,GACA5B,EAAA,cAAA4C,SAAA,QACAN,OAAAO,QAAAC,UAAA,KAAA,KAAA7C,EAAAO,IACAA,IACAqB,EAAAI,KAAAA,GAAAc,KAAA,OAAA9C,EAAAO","file":"load-more.js","sourcesContent":["jQuery(function($){\n\n\tvar $list = $('.post-listing');\n\n\t// Next posts\n\tvar $next = $('.nav-next');\n\t$list.prepend( $next );\n\n\tvar $nav = $('.posts-navigation');\n\tvar $button = $('.nav-previous');\n\tvar $link = $button.find('a');\n\n\tif ( ! $button.length ) return;\n\n\tvar page = parseInt(bsloadmore.page) + 1;\n\tvar cache_version = page;\n\tvar loading = false;\n\tvar cached = false;\n\tvar text = $link.text();\n\tvar loadingText = bsloadmore.loadingText;\n\n\tvar next_page = '';\n\n\tvar data = {\n\t\taction: 'bs_ajax_load_more',\n\t\tnonce: bsloadmore.nonce,\n\t\tpage: page,\n\t\tquery: bsloadmore.query\n\t};\n\n\t/**\n\t * Necessary functions\n\t */\n\n\tfunction get_next_url ( p ) {\n\t\treturn bsloadmore.next_link.replace( '9999', p );\n\t}\n\n\tfunction cache_next_page () {\n\t\tcache_version = page;\n\t\tget_next_page(function ( data ) {\n\t\t\tif ( data ) {\n\t\t\t\tnext_page = data;\n\t\t\t\tcached = true;\n\t\t\t} else {\n\t\t\t\t$button.remove();\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction get_next_page ( cb ) {\n\n\t\tif ( cached && cache_version === page ) {\n\t\t\tcb( next_page );\n\t\t\tcached = false;\n\t\t\tloading = false;\n\t\t\tcache_next_page();\n\t\t\treturn;\n\t\t}\n\n\t\tdata.page = page;\n\t\t$.post(bsloadmore.url, data, function(res) {\n\t\t\tif( res.success) {\n\t\t\t\tcb( res.data );\n\t\t\t\tloading = false;\n\t\t\t} else {\n\t\t\t\tcb('');\n\t\t\t\t// console.log(res);\n\t\t\t}\n\t\t}).fail(function(xhr, textStatus, e) {\n\t\t\tcb('');\n\t\t\t// console.log(xhr.responseText);\n\t\t});\n\t}\n\n\t/**\n\t * Loading the next page automatically and on button click\n\t */\n\n\t$(window).load(function () {\n\t\tsetTimeout( function () {\n\t\t\tcache_next_page();\n\t\t}, 1000);\n\t});\n\n\t$button.click(function (e) {\n\t\te.preventDefault();\n\t\tif ( loading ) return;\n\t\tloading = true;\n\t\t$link.text( loadingText );\n\n\t\tget_next_page(function ( data ) {\n\t\t\t$list.append( data ).append( $nav );\n\t\t\t$('.type-post').addClass('post');\n\t\t\twindow.history.pushState( null, null, get_next_url( page ) );\n\t\t\tpage++;\n\t\t\t$link.text( text ).attr( 'href', get_next_url( page ) );\n\t\t});\n\n\t});\n\n});"],"sourceRoot":"assets/scripts/"}